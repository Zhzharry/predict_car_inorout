## 方案三：长短期记忆网络（LSTM）分类方案
### 一、方案核心思路
LSTM作为递归神经网络（RNN）的改进模型，通过门控机制（输入门、遗忘门、输出门）解决了传统RNN的长时依赖问题，能够有效捕捉时序数据的动态变化规律。本方案利用传感器数据的时序特性，将特征矩阵转化为时序序列数据，通过LSTM网络提取时间维度上的特征依赖（如进地库过程中光照强度的持续下降、LTE信号的逐步减弱），构建端到端的分类模型，实现三类场景的精准识别，尤其适用于依赖时序趋势的检测任务。

### 二、分步实施流程
#### （一）数据准备与时序化处理
1. **数据加载与拆分**：同方案一的“数据加载”和“数据拆分”步骤，保持数据分布的一致性。
2. **数据清洗与标准化**：处理异常值和缺失值，对特征矩阵进行标准化处理，消除量纲差异。
3. **时序序列构造**：基于数据的采集时间戳，将特征矩阵按时间顺序排序，构建固定长度的滑动时间窗口（如窗口大小为10-30个连续样本），每个窗口对应一个时序序列样本，窗口的标签由窗口内占比最高的类别确定（或窗口中心样本的标签）。
4. **数据格式转换**：将时序序列样本转换为LSTM网络适配的输入格式（样本数×时间步长×特征维度），其中时间步长为滑动窗口大小，特征维度为每个样本的特征数量。

#### （二）LSTM网络结构设计
1. **输入层**：接收时序化后的特征序列，输入维度为（None，时间步长，特征维度），其中None表示支持任意批量大小的输入。
2. **LSTM层**：设置1-2层LSTM单元，每层LSTM单元数量为32-128（根据数据复杂度调整），第一层LSTM层输出完整的时序特征序列，第二层（若有）进一步提取高阶时序特征；设置Dropout层（ dropout率为0.2-0.5），防止模型过拟合。
3. **全连接层**：将LSTM层的输出（最后一个时间步的特征向量或所有时间步的平均特征向量）输入全连接层，通过ReLU激活函数进行非线性变换，映射到低维特征空间。
4. **输出层**：采用Softmax激活函数，输出3个类别的概率分布（对应0、1、2类），概率最大的类别为最终预测结果。

#### （三）模型训练与优化
1. **损失函数与优化器选择**：采用交叉熵损失函数（适配多分类任务），选择Adam优化器（自适应学习率，收敛速度快），设置合理的学习率（如0.001）。
2. **类别平衡处理**：针对训练集类别不平衡问题，采用类别权重加权（少数类权重高于多数类）或过采样（增加少数类样本数量）、欠采样（减少多数类样本数量）的方法，提升模型对少数类的识别能力。
3. **模型训练**：设置训练批次大小（batch_size）和训练轮数（epochs），使用训练子集进行模型训练，同时利用本地测试子集进行验证，监控验证集准确率和损失值，采用早停机制（Early Stopping）防止过拟合（当验证集损失值连续多轮上升时停止训练）。
4. **模型调优**：调整LSTM单元数量、时间步长、Dropout率、学习率等超参数，通过交叉验证优化模型性能，输出最优训练模型。

#### （四）模型预测与结果生成
1. **本地测试预测**：将时序化后的本地测试子集输入最优LSTM模型，得到每个时序窗口的类别概率分布，取概率最大的类别作为预测标签，还原为原始样本的预测结果（按窗口对应关系映射）。
2. **验证集预测**：对验证集的每个文件执行“数据清洗→标准化→时序化处理→模型预测”流程，还原每个原始样本的预测标签，追加labelArea列后保存，确保格式与训练集一致。

#### （五）模型评估（适配作业4项评价指标）
1. **预测准确率**：计算本地测试子集原始样本的预测准确率，结合实时检测约束（规定时间窗口内检测）统计有效检测率，重点关注少数类（1、2类）的召回率。
2. **检测时延**：模拟实时场景，统计单样本（时序窗口）的平均预测耗时，需确保预测过程仅依赖当前及历史时序数据，不使用未来数据。
3. **计算效率**：统计本地测试子集的整体预测耗时，计算单位时间内的样本处理量，评估模型的实时处理能力。
4. **模型大小**：统计LSTM模型的参数量（LSTM单元数、全连接层权重数等），估算模型文件存储大小（如.h5格式文件大小），评估模型的轻量化程度。
